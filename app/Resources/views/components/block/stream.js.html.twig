
<script>
  $('#stream-flux').ready(function(){
    var idCamera = $('#stream-flux').attr('data-camera')
    $.ajax({
      url: '{{ path('cameras_ajax_spectateur') }}',
      method: 'POST',
      data: {
        idCamera: idCamera
      },
      success: function(){
        spanViewers = $('#nb-viewer')
        var viewers = parseInt(spanViewers.text())
        spanViewers.text(++viewers)
      }
    })
    window.onbeforeunload = function(){
       $.ajax({
         url: '{{ path('cameras_ajax_despectateur') }}',
         method: 'POST',
         data: {
           idCamera: idCamera
         }
       })
    }
  })

  var play = $('#stream-flux').attr('data-play')
  $('#stream-control').click(function(e){
    e.preventDefault()
    if(play){
      $(this).html('<i class="fa fa-play tippy" title="Relancer le direct"></i>')
      $('#stream-flux').attr('src', $(this).attr('data-pause'))
    }else{
      $(this).html('<i class="fa fa-pause tippy" title="Mettre le direct en pause"></i>')
      $('#stream-flux').attr('src', $(this).attr('data-play'))
    }
    play = !play
    new Tippy('.tippy')
  })

</script>
